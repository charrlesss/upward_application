"use strict";(self.webpackChunkupward=self.webpackChunkupward||[]).push([[1012],{71012:function(e,t,n){n.d(t,{mp:function(){return H},PE:function(){return F},ZP:function(){return T},pw:function(){return N}});var r,i=n(93433),a=n(37762),o=n(74165),c=n(15861),l=n(29439),s=n(4942),d=n(1413),u=n(72791),p=n(58340),h=n(13400),f=n(36151),m=n(67236),x=n(41788),v=n(87122),g=n(5519),w=n(29823),y=n(98008),j=n(41128),b=n(46360),k=n(16386);function Z(e){return(r=r||(0,c.Z)((0,o.Z)().mark((function e(t){var n,r,i,a,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new Blob([t],{type:"application/vnd.ms-excel"}),r="filename.xls",i=new File([n],r),e.next=6,window.showSaveFilePicker({suggestedName:r});case 6:return a=e.sent,e.next=9,a.createWritable();case 9:return c=e.sent,e.next=12,c.write(i);case 12:return e.next=14,c.close();case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("Error saving file:",e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}var L=n(80184),C=[],S="",E=100;function z(e){var t=e.querySelector(".content table"),n=(new XMLSerializer).serializeToString(t),r=t.getBoundingClientRect().height,i=t.getBoundingClientRect().width,a="0 0 ".concat(i," ").concat(r),o=0;return o=E<100?100-E+100:E>100?100-(E-100):100,"data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg"  width="'.concat(o,'%" height="').concat(o,'%">\n          <foreignObject viewBox="').concat(a,'" width="100%" height="100%">\n              ').concat(n,"\n          </foreignObject>\n          <style>\n              .page{\n                  page-break-after: always;\n                  display: flex;\n                  flex-direction: column;\n                  height: 100vh;\n                  width: 100vw;\n                  box-shadow: 1px 1px 1px black;\n              }\n              .content{\n                  flex: 1;\n                  block-size: fit-content;\n                  text-align: center;\n              }\n              table {\n                border-collapse: collapse;\n                border-spacing: 50px\n              }\n              thead tr.headerColumn{\n                  border-bottom: 1px solid black;\n              }\n              .content img{\n                  width: 97%;\n                  height: 100%;\n              }\n              .footer, .header{\n                  padding-left: 50px;\n                  padding-right: 50px;\n              }\n              td, th{\n              font-family: 'Lato', sans-serif;\n              font-weight: 700;\n              padding: 0px 5px;\n            }\n         \n          </style> \n        </svg>"))}var M=function(e,t){return"UPDATE_FIELD"===t.type?(0,d.Z)((0,d.Z)({},e),{},(0,s.Z)({},t.field,t.value)):e};function T(e){var t,n,r,i,s=e.Setting,d=e.onReportSubmit,h=e.drawTable,f=e.initialState,m=e.column,x=e.scaleDefaultValue,v=e.pageHeight,g=void 0===v?"8.5in":v,w=e.pageWidth,y=void 0===w?"15in":w,j=e.addHeaderGroup,b=void 0===j?(0,L.jsx)(L.Fragment,{}):j,M=e.activePagination,T=void 0!==M&&M;x&&(E=x);var N=(0,u.useRef)(null),H=(0,u.useState)([]),D=(0,l.Z)(H,2),F=D[0],W=D[1],q=(0,u.useState)([]),I=(0,l.Z)(q,2),R=I[0],B=I[1],A=(0,u.useState)(0),V=(0,l.Z)(A,2),U=V[0],G=V[1],K=(0,u.useState)(!1),O=(0,l.Z)(K,2),_=O[0],Y=O[1],J=function(e){return(t=t||(0,c.Z)((0,o.Z)().mark((function e(t){var n,r,i,a,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=z(t),r='<img src="'+n+'" />',i=t.querySelector(".header"),a='<div class="content">'.concat(r,"</div>"),c=t.querySelector(".footer"),e.abrupt("return",'<div class="page">'.concat(i.outerHTML).concat(a).concat(c.outerHTML,"</div>"));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)};function X(){return(n=n||(0,c.Z)((0,o.Z)().mark((function e(){var t,n,r,i,c,l;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="",n=(0,a.Z)(R),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=15;break}return i=r.value,(c=document.createElement("div")).innerHTML=(0,p.renderToString)(i),l=c.firstChild,e.t0=t,e.next=12,J(l);case 12:t=e.t0+=e.sent;case 13:e.next=4;break;case 15:e.next=20;break;case 17:e.prev=17,e.t1=e.catch(2),n.e(e.t1);case 20:return e.prev=20,n.f(),e.finish(20);case 23:return e.abrupt("return",t);case 24:case"end":return e.stop()}}),e,null,[[2,17,20,23]])})))).apply(this,arguments)}return(0,u.useEffect)((function(){window.addEventListener("copy",(function(){C.length>0&&""!==S&&navigator.clipboard.writeText(S)}))}),[]),(0,u.useEffect)((function(){function e(e){document.querySelectorAll("".concat(e)).forEach((function(t){t.addEventListener("click",(function(){document.querySelectorAll("".concat(e)).forEach((function(e){e.classList.remove("active")})),t.classList.add("active")}))}))}document.addEventListener("click",(function(e){var t=e.target;t.closest("td")||document.querySelectorAll("td").forEach((function(e){e.classList.remove("active")})),t.closest("th")||document.querySelectorAll("th").forEach((function(e){e.classList.remove("active")}))})),e("td"),e("th")})),(0,u.useEffect)((function(){document.documentElement.style.setProperty("--custom-pageHeight",g),document.documentElement.style.setProperty("--custom-pageWidth",y)}),[g,y]),(0,u.useEffect)((function(){var e;B(h(F,null===(e=N.current)||void 0===e?void 0:e.getState()))}),[F,h]),(0,L.jsxs)("div",{className:"main",children:[(0,L.jsx)(P,{ref:N,clickPrint:function(){return(r=r||(0,c.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(E<0||E>200)){e.next=2;break}return e.abrupt("return",alert("invalid scale"));case 2:return e.next=4,X().then((function(e){var t,n=document.createElement("iframe");n.style.display="none",document.body.appendChild(n);var r=n.contentDocument||(null===(t=n.contentWindow)||void 0===t?void 0:t.document),i='\n                    <!DOCTYPE html>\n                    <html lang="en">\n                    <head>\n                        <meta charset="UTF-8">\n                        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                        <title>Printed HTML Content</title>\n                        <style>\n                        @import url(\'https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap\');\n                        @media print {\n                          @page{\n                              margin-top: 0mm;\n                              margin-bottom: 0mm;\n                              margin-left: 0mm;\n                              margin-right: 0mm;\n                          }\n                          body {\n                                margin: 0;\n                                padding: 0;\n                            }\n                          .page{\n                              page-break-after: always;\n                              display: flex;\n                              flex-direction: column;\n                              height: 100vh;\n                              width: 100vw;\n                              box-shadow: 1px 1px 1px black;\n                          }\n                          .content{\n                              flex: 1;\n                              block-size: fit-content;\n                              text-align: center;\n                          }\n                          .content img{\n                              width: 95%;\n                              height: 100%;\n                          }\n                          .footer, .header{\n                            padding-left: 50px;\n                            padding-right: 50px;\n                          }\n                          \n                            .page table td,.page table th{\n                              font-family: "Roboto", sans-serif;\n                              font-weight: 100;\n                              font-style: normal;\n                          }\n                        }\n    \n                        </style>\n                    </head>\n                    <body>\n                          '.concat(e,"\n                    </body>\n                    </html>\n                ");null===r||void 0===r||r.open(),null===r||void 0===r||r.write(i),null===r||void 0===r||r.close(),setTimeout((function(){var e,t;null===(e=n.contentWindow)||void 0===e||e.print(),null===(t=n.parentNode)||void 0===t||t.removeChild(n)}),1e3)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onReportSubmit:d,Setting:s,setData:W,setLoading:Y,initialState:f,exportToExcel:function(){return(i=i||(0,c.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="",n=R.map((function(e){var t=document.createElement("div");return t.innerHTML=(0,p.renderToString)(e),t.querySelector("table")})),t+="<table>",n.forEach((function(e,r){if(0===r){var i=e.querySelector("thead");t+=null===i||void 0===i?void 0:i.outerHTML}var a=e.querySelector("tbody");if(t+=null===a||void 0===a?void 0:a.outerHTML,r===n.length-1){var o=e.querySelector("tfoot");t+=null===o||void 0===o?void 0:o.outerHTML}})),Z(t+="</table>");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)},activePagination:T,pageNumber:U,setPageNumber:G,pages:R}),(0,L.jsxs)("div",{className:"main-page",children:[(F.length<=0||_)&&(0,L.jsxs)("div",{className:"page out-page",style:{width:y,height:g},children:[(0,L.jsx)("div",{className:"header",style:{height:"50px"}}),(0,L.jsx)("div",{className:"content",children:(0,L.jsxs)("table",{children:[(0,L.jsxs)("thead",{children:[f.title.split("\n").map((function(e,t){return(0,L.jsx)("tr",{children:(0,L.jsx)("td",{style:{fontSize:"14px",fontWeight:"bold",textAlign:"left"},colSpan:3,children:e})},t)})),(0,L.jsx)("tr",{style:{height:"40px"}}),b,(0,L.jsx)("tr",{className:"headerColumn",children:m.map((function(e,t){return(0,L.jsx)("th",{style:{fontSize:"13px",fontWeight:"bold",borderBottom:"1px solid black"},children:e.header},t)}))})]}),(0,L.jsx)("tbody",{})]})}),(0,L.jsxs)("div",{className:"footer",style:{height:"50px",display:"flex",justifyContent:"space-between"},children:[(0,L.jsx)("p",{style:{fontSize:"10px",fontWeight:"bold"},children:(0,k.Z)(new Date,"MM/dd/Y")}),(0,L.jsx)("p",{style:{fontSize:"10px",fontWeight:"bold"},children:"Page 1 of 1"})]})]}),_?(0,L.jsx)("div",{className:"main-loader",children:(0,L.jsx)("div",{className:"main-loader-content",children:(0,L.jsx)("div",{className:"lds-dual-ring"})})}):(0,L.jsx)(L.Fragment,{children:R[U]})]})]})}var P=(0,u.forwardRef)((function(e,t){var n=e.clickPrint,r=e.onReportSubmit,i=e.Setting,a=e.setData,o=e.setLoading,c=e.initialState,s=e.exportToExcel,d=e.activePagination,p=void 0!==d&&d,k=e.pageNumber,Z=e.setPageNumber,C=e.pages,S=(0,j.Z)(),z=S.searchParams,T=S.setSearchParams,P=(0,u.useState)(!1),N=(0,l.Z)(P,2),H=N[0],D=N[1],F=(0,u.useState)(0),W=(0,l.Z)(F,2),q=W[0],I=W[1],R=(0,u.useReducer)(M,c),B=(0,l.Z)(R,2),A=B[0],V=B[1];function U(){T((function(e){return e.set("drawer",("false"===z.get("drawer")).toString()),e}),{replace:!0})}(0,u.useImperativeHandle)(t,(function(){return{getState:function(){return A}}}));var G="true"===z.get("drawer");return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"main-header",children:[(0,L.jsx)("div",{children:(0,L.jsx)(h.Z,{size:"small",color:"secondary",onClick:function(){return U()},style:{marginTop:"5px"},children:(0,L.jsx)(y.Z,{color:"secondary"})})}),(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"10px"},children:[!p&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center"},id:"paggination-container",children:[(0,L.jsx)(h.Z,{color:"primary",onClick:function(){Z(0)},children:(0,L.jsxs)("svg",{width:"18px",height:"18px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,L.jsx)("path",{d:"M19 19L12.7071 12.7071C12.3166 12.3166 12.3166 11.6834 12.7071 11.2929L19 5",stroke:"#000000",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,L.jsx)("path",{d:"M11 19L4.70711 12.7071C4.31658 12.3166 4.31658 11.6834 4.70711 11.2929L11 5",stroke:"#000000",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,L.jsx)(h.Z,{color:"primary",onClick:function(){k<=0||Z(k-1)},children:(0,L.jsx)("svg",{width:"18px",height:"18px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,L.jsx)("path",{d:"M14.2893 5.70708C13.8988 5.31655 13.2657 5.31655 12.8751 5.70708L7.98768 10.5993C7.20729 11.3805 7.2076 12.6463 7.98837 13.427L12.8787 18.3174C13.2693 18.7079 13.9024 18.7079 14.293 18.3174C14.6835 17.9269 14.6835 17.2937 14.293 16.9032L10.1073 12.7175C9.71678 12.327 9.71678 11.6939 10.1073 11.3033L14.2893 7.12129C14.6799 6.73077 14.6799 6.0976 14.2893 5.70708Z",fill:"#0F0F0F"})})}),(0,L.jsx)(h.Z,{onClick:function(){k>=C.length-1||Z(k+1)},children:(0,L.jsx)("svg",{width:"18px",height:"18px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,L.jsx)("path",{d:"M9.71069 18.2929C10.1012 18.6834 10.7344 18.6834 11.1249 18.2929L16.0123 13.4006C16.7927 12.6195 16.7924 11.3537 16.0117 10.5729L11.1213 5.68254C10.7308 5.29202 10.0976 5.29202 9.70708 5.68254C9.31655 6.07307 9.31655 6.70623 9.70708 7.09676L13.8927 11.2824C14.2833 11.6729 14.2833 12.3061 13.8927 12.6966L9.71069 16.8787C9.32016 17.2692 9.32016 17.9023 9.71069 18.2929Z",fill:"#0F0F0F"})})}),(0,L.jsx)(h.Z,{onClick:function(){Z(C.length-1)},children:(0,L.jsxs)("svg",{width:"18px",height:"18px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,L.jsx)("path",{d:"M5.5 5L11.7929 11.2929C12.1834 11.6834 12.1834 12.3166 11.7929 12.7071L5.5 19",stroke:"#000000",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,L.jsx)("path",{d:"M13.5 5L19.7929 11.2929C20.1834 11.6834 20.1834 12.3166 19.7929 12.7071L13.5 19",stroke:"#000000",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),(0,L.jsx)("label",{children:"Custom Page"}),(0,L.jsx)("input",{style:{width:"80px"},onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code){e.preventDefault();var t=e.target.value;if(""===t||void 0===t||null===t)return alert("Input is required field");var n=parseInt(t)-1;if(n>C.length-1||n<0)return alert("Invalid Page");Z(n)}},placeholder:"".concat(k),min:0,max:200,id:"cs-page"})]}),(0,L.jsx)("label",{htmlFor:"scale",id:"scale-lbl",children:"Scale"}),(0,L.jsxs)("select",{id:"scale",value:q,onChange:function(e){return I(parseInt(e.target.value))},children:[(0,L.jsx)("option",{value:0,children:"default"}),(0,L.jsx)("option",{value:1,children:"Custom"})]}),1===q&&(0,L.jsx)("input",{style:{width:"80px"},type:"number",onChange:function(e){E=parseInt(e.target.value)},placeholder:"".concat(E),onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(e.preventDefault(),n())}}),(0,L.jsx)(h.Z,{onClick:n,children:(0,L.jsx)(m.Z,{color:"primary"})}),(0,L.jsx)(h.Z,{size:"small",color:"success",onClick:s,children:(0,L.jsx)(x.Z,{color:"success"})}),(0,L.jsx)(h.Z,{size:"small",sx:{color:g.Z[700]},onClick:function(){D((function(e){return!e}))},children:(0,L.jsx)(v.Z,{sx:{color:g.Z[700]}})})]})]}),H&&(0,L.jsx)("div",{className:"modal-setting",onClick:function(){return D(!1)},children:(0,L.jsx)("div",{className:"modal-content",onClick:function(e){return e.stopPropagation()},children:(0,L.jsxs)("div",{children:[(0,L.jsx)(h.Z,{color:"info",size:"small",sx:{position:"absolute",top:"10px",right:"10px"},onClick:function(){return D(!1)},children:(0,L.jsx)(w.Z,{sx:{fontSize:"18px"}})}),(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{children:i(A,V)}),(0,L.jsx)("div",{style:{width:"100%",position:"fixed",bottom:"0"},children:(0,L.jsx)(f.Z,{fullWidth:!0,onClick:function(){D(!1),o(!0),r(a,o,A)},children:"Generate Report"})})]})]})})}),(0,L.jsx)(b.Z,{open:G,drawerWidth:280,handleDrawerClose:function(){return U()}})]})}));function N(e){return e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function H(e){var t=e.target,n=Array.from(t.classList).filter((function(e){return e.includes("page")}))[0].split("-"),r=Array.from(t.classList).filter((function(e){return e.includes("row")}))[0].split("_"),a=r[0].split("-")[1],o=r[1].split("-")[1];if(document.querySelectorAll(".selected").forEach((function(e){return e.classList.remove("selected")})),"TD"===t.tagName&&e.ctrlKey){e.preventDefault(),C.length<=0&&D(a,o,n[1]);for(var c=[{x:a,y:o}].concat((0,i.Z)(C)),l=parseInt(a),s=Math.min.apply(Math,(0,i.Z)(c.map((function(e){return parseInt(e.x)})))),d=parseInt(o),u=Math.min.apply(Math,(0,i.Z)(c.map((function(e){return parseInt(e.y)})))),p="",h=s;h<=l;h++){for(var f=u;f<=d;f++){var m=D(h,f,n[1]);m&&(p+=m.textContent),p+=f===d?"":","}p+="\n"}S=p,C.push({x:a,y:o})}else C=[],S=""}function D(e,t,n){var r=document.querySelector(".page-".concat(n,".row-").concat(e,"_col-").concat(t));return r?(r.classList.add("selected"),r):null}function F(e,t,n){var r=n.flat().map((function(e){return e[t]})).join("\n");navigator.clipboard.writeText(r);var i=e.target.getBoundingClientRect(),a=document.createElement("span");document.body.appendChild(a),a.textContent="Copied",a.style="position:absolute; top:".concat(i.top-40,"px;left:").concat(i.left+i.width/2-30,"px;background:#0891b2;color:white;border-radius:20px;font-size:11px; padding:5px;"),a.classList.add("copied-message");var o=setTimeout((function(){clearTimeout(o),document.body.removeChild(a)}),800)}},41788:function(e,t,n){var r=n(64836);t.Z=void 0;var i=r(n(45649)),a=n(80184),o=(0,i.default)((0,a.jsx)("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"}),"LibraryBooks");t.Z=o},67236:function(e,t,n){var r=n(64836);t.Z=void 0;var i=r(n(45649)),a=n(80184),o=(0,i.default)((0,a.jsx)("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"}),"LocalPrintshop");t.Z=o},87122:function(e,t,n){var r=n(64836);t.Z=void 0;var i=r(n(45649)),a=n(80184),o=(0,i.default)((0,a.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"}),"Settings");t.Z=o}}]);
//# sourceMappingURL=1012.5980877f.chunk.js.map