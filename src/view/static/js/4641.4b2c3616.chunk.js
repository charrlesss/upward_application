(self.webpackChunkupward=self.webpackChunkupward||[]).push([[4641],{53147:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return H},reducer:function(){return G}});var i=n(93433),o=n(74165),a=n(15861),r=n(29439),c=n(4942),l=n(1413),u=n(72791),d=n(48550),s=n(36151),h=n(68096),p=n(94925),f=n(77196),m=n(63466),x=n(13400),D=n(88447),C=n(64554),g=n(20890),k=n(58406),S=n(23786),v=n(13784),b=n(39709),y=n(42419),R=n(53329),N=n(29823),A=n(21830),I=n.n(A),_=n(86753),E=n(91933),L=n(3380),F=n(84669),j=n(98946),T=n(16395),Z=n(93263),w=n(54164),M=n(89767),P=n(25756),B=n(64230),U=n(81582),z=n(80184),W={RefNo:"",Sub_RefNo:"",DateReturn:new Date,Explanation:"Returned Checks",search:"",returnMode:"",searchCheckList:""},O={ModalDateReturn:(new Date).toLocaleDateString(),ReturnReason:"",AccountName:"",AccountID:"",Amount:"",SubAccount:"",BranchCode:"",IDNo:"",Short:"",Check_No:"",TempID:"",updateAmount:"",updateAmountID:"",depoBankName:"",depoBankIdentity:"",subSelectedChecks:{}},K=(0,u.createContext)({checkCollection:[],checkSelectedCollection:[],accountingEntry:[],LoadingCheckList:!1,addReturnCheckLoading:!1,tableSelectedCheck:{current:{}},tableAccountingEntryCheck:{current:{}},tableSelectedCheckReturn:{current:{}},dispatchModal:function(){},modalSelectedMutate:function(){},getSearchReturnCheckInfoLoading:!1,modalSelectedCheckLoading:!1,debitModalCollection:[],myAxios:{},user:{},setCheckCollection:function(){},openSelectedCheckModal:!1,setOpenSelectedCheckModal:function(){},currentStepIndex:0,fireModal:function(){},stateModal:{},datePickerModalRef:{current:null},setAccountingEntry:function(){},handleModalInputChange:function(){},LoadSelectedCheckInSelectedTable:function(){},setCheckSelectedCollection:function(){}}),q=[{title:"Selected Check",index:0},{title:"Selected Check to be Returned",index:1},{title:"Accounting Entry",index:2}],X=[{field:"CRCode",headerName:"Code",minWidth:140},{field:"CRTitle",headerName:"Account Name",minWidth:300,flex:1},{field:"Credit",headerName:"Amount",minWidth:140,align:"right"},{field:"CRLoanID",headerName:"ID No.",minWidth:140},{field:"CRLoanName",headerName:"Identity",minWidth:300,flex:1},{field:"SubAcctCode",headerName:"Sub Account",minWidth:160,flex:1},{field:"SubAcctName",headerName:"Sub Account Name",minWidth:300,flex:1},{field:"TempID",headerName:"Sub Account Name",hide:!0}],G=function(e,t){return"UPDATE_FIELD"===t.type?(0,l.Z)((0,l.Z)({},e),{},(0,c.Z)({},t.field,t.value)):e};function H(){var e,t,n,c,A,U=Q(),H=U.ConfirmationModal,Y=U.fireModal,ie=(0,u.useContext)(L.V),oe=ie.myAxios,ae=ie.user,re=(0,u.useReducer)(G,W),ce=(0,r.Z)(re,2),le=ce[0],ue=ce[1],de=(0,u.useReducer)(G,O),se=(0,r.Z)(de,2),he=se[0],pe=se[1],fe=(0,P.Z)([(0,z.jsx)(V,{}),(0,z.jsx)(J,{}),(0,z.jsx)($,{})]),me=fe.currentStepIndex,xe=fe.step,De=fe.goTo,Ce=(0,u.useState)([]),ge=(0,r.Z)(Ce,2),ke=ge[0],Se=ge[1],ve=(0,u.useState)([]),be=(0,r.Z)(ve,2),ye=be[0],Re=be[1],Ne=(0,u.useState)([]),Ae=(0,r.Z)(Ne,2),Ie=Ae[0],_e=Ae[1],Ee=(0,u.useState)([]),Le=(0,r.Z)(Ee,2),Fe=Le[0],je=Le[1],Te=(0,u.useState)(!1),Ze=(0,r.Z)(Te,2),we=Ze[0],Me=Ze[1],Pe=(0,u.useRef)(null),Be=(0,u.useRef)(null),Ue=(0,u.useRef)(null),ze=(0,u.useRef)(null),We=(0,u.useRef)(null),Oe=(0,u.useRef)(null),Ke=(0,u.useRef)(null),qe=(0,u.useRef)(null),Xe=(0,u.useRef)(null),Ge=(0,E.useQuery)({queryKey:"return-check-id",queryFn:function(){return(e=e||(0,a.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe.get("/task/accounting/get-new-return-check-id",{headers:{Authorization:"Bearer ".concat(null===ae||void 0===ae?void 0:ae.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},refetchOnWindowFocus:!1,onSuccess:function(e){var t=e;"UCSMI"!==(null===ae||void 0===ae?void 0:ae.department)&&(ue({type:"UPDATE_FIELD",field:"RefNo",value:t.data.returnCheckID[0].return_check_id}),ue({type:"UPDATE_FIELD",field:"Sub_RefNo",value:t.data.returnCheckID[0].return_check_id}))}}),He=Ge.isLoading,Ye=Ge.refetch,Qe=(0,E.useQuery)({queryKey:"check-list",queryFn:function(){return(t=t||(0,a.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe.get("/task/accounting/get-check-list?checkListSearch=".concat(le.searchCheckList),{headers:{Authorization:"Bearer ".concat(null===ae||void 0===ae?void 0:ae.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){Se(e.data.checkList)}}),Ve=Qe.isLoading,Je=Qe.refetch,$e=(0,E.useMutation)({mutationKey:"selected-check-modal",mutationFn:function(e){return(n=n||(0,a.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oe.post("/task/accounting/get-modal-return-check-data",t,{headers:{Authorization:"Bearer ".concat(null===ae||void 0===ae?void 0:ae.accessToken)}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var t=e,n=t.data.credit[0],i=t.data.debit[0];console.log(t),je(t.data.debit),pe({type:"UPDATE_FIELD",field:"AccountName",value:n.Acct_Title}),pe({type:"UPDATE_FIELD",field:"AccountID",value:n.Account_ID}),pe({type:"UPDATE_FIELD",field:"IDNo",value:i.ID_No}),pe({type:"UPDATE_FIELD",field:"Short",value:i.CRLoanName}),pe({type:"UPDATE_FIELD",field:"depoBankName",value:n.IDNo}),pe({type:"UPDATE_FIELD",field:"depoBankIdentity",value:n.Identity}),pe({type:"UPDATE_FIELD",field:"Short",value:i.CRLoanName}),pe({type:"UPDATE_FIELD",field:"Short",value:i.CRLoanName}),pe({type:"UPDATE_FIELD",field:"SubAccount",value:i.SubAcctName}),pe({type:"UPDATE_FIELD",field:"BranchCode",value:i.SubAcctCode}),pe({type:"UPDATE_FIELD",field:"Amount",value:t.data.debit.reduce((function(e,t){return e+parseFloat(t.Credit.replace(/,/g,""))}),0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),Me(!0)}}),et=$e.isLoading,tt=$e.mutate,nt=(0,E.useMutation)({mutationKey:"selected-search-return-check",mutationFn:function(e){return(c=c||(0,a.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oe.post("/task/accounting/get-search-selected-checks-information",t,{headers:{Authorization:"Bearer ".concat(null===ae||void 0===ae?void 0:ae.accessToken)}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var t=e,n=t.data.selected[0],i=t.data.selected.map((function(e){return e.Amount=parseFloat(e.Amount.toString().replace(/,/g,"")).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),e}));_e(t.data.accountingEntry),Re(i),ee(ue,(0,l.Z)((0,l.Z)({},le),{RefNo:n.RC_No,Sub_RefNo:n.RC_No,DateReturn:n.RC_Date,Explanation:n.Explanation,returnMode:"edit"}))}}),it=nt.isLoading,ot=nt.mutate,at=(0,E.useMutation)({mutationKey:"selected-check-modal",mutationFn:function(e){return(A=A||(0,a.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oe.post("/task/accounting/add-return-check",t,{headers:{Authorization:"Bearer ".concat(null===ae||void 0===ae?void 0:ae.accessToken)}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var t=e;return t.data.isClearableError?(Ye(),Je(),Re([]),_e([]),ue({type:"UPDATE_FIELD",field:"returnMode",value:""}),I().fire({position:"center",icon:"success",title:t.data.message,timer:1500})):I().fire({position:"center",icon:"warning",title:t.data.message,timer:1500})}}),rt=at.isLoading,ct=at.mutate,lt=(0,Z.Z)({link:{url:"/task/accounting/search-return-checks",queryUrlName:"searchReturnChecks"},columns:[{field:"RC_Date",headerName:"Date",width:150},{field:"RC_No",headerName:"Slip Code",width:170},{field:"Explanation",headerName:"Bank Account",flex:1}],queryKey:"return-checks-search",uniqueId:"RC_No",responseDataKey:"returnCheckSearch",onSelected:function(e){ue({type:"UPDATE_FIELD",field:"returnMode",value:"edit"}),ot({RC_No:e[0].RC_No}),ht()},onCloseFunction:function(e){ue({type:"UPDATE_FIELD",field:"search",value:e})},searchRef:Oe}),ut=lt.ModalComponent,dt=lt.openModal,st=lt.isLoading,ht=lt.closeModal,pt=function(e){var t=e.target,n=t.name,i=t.value;ue({type:"UPDATE_FIELD",field:n,value:i})},ft=function(e){var t=e.target,n=t.name,i=t.value;pe({type:"UPDATE_FIELD",field:n,value:i})};function mt(e){return e.preventDefault(),""===le.Explanation?I().fire({position:"center",icon:"warning",title:"Please provide an explanation",timer:1500}).then((function(e){(0,T.wait)(350).then((function(){var e;null===(e=ze.current)||void 0===e||e.focus()}))})):ye.length<=0?I().fire({position:"center",icon:"warning",title:"Please provide return entry!",timer:1500}):Ie.reduce((function(e,t){return e+parseFloat(t.Credit.replace(/,/g,""))}),0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})!==Ie.reduce((function(e,t){return e+parseFloat(t.Debit.replace(/,/g,""))}),0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})?I().fire({position:"center",icon:"warning",title:"Accounting entry must be equal in Debit and Credit amount!",timer:1500}).then((function(){(0,T.wait)(300).then((function(){De(3)}))})):void("edit"===le.returnMode?(0,B.s)({isUpdate:!0,cb:function(e){ct({selected:ye,accountingEntry:Ie,RefNo:le.RefNo,Sub_RefNo:le.Sub_RefNo,DateReturn:le.DateReturn,Explanation:le.Explanation,ModalDateReturn:he.ModalDateReturn,ReturnReason:he.ReturnReason,AccountName:he.AccountName,AccountID:he.AccountID,Amount:he.Amount,SubAccount:he.SubAccount,BranchCode:he.BranchCode,IDNo:he.IDNo,Short:he.Short,Check_No:he.Check_No,isUpdated:"edit"===le.returnMode,userCodeConfirmation:e})}}):(0,B.L)({isConfirm:function(){ct({selected:ye,accountingEntry:Ie,RefNo:le.RefNo,Sub_RefNo:le.Sub_RefNo,DateReturn:le.DateReturn,Explanation:le.Explanation,ModalDateReturn:he.ModalDateReturn,ReturnReason:he.ReturnReason,AccountName:he.AccountName,AccountID:he.AccountID,Amount:he.Amount,SubAccount:he.SubAccount,BranchCode:he.BranchCode,IDNo:he.IDNo,Short:he.Short,Check_No:he.Check_No,isUpdated:"edit"===le.returnMode})}}))}function xt(e){var t={Temp_OR:"".concat(e.Official_Receipt).concat((ke.length+1).toString().padStart(2,"0")),OR_NO:e.Official_Receipt,OR_Date:e.Date_OR,DepoSlip:e.DepoSlip,DepoDate:e.DepoDate,Check_No:e.Check_No,Check_Date:e.Check_Date,Amount:e.Amount,Bank:e.Bank,Bank_Account:e.BankAccount,Reason:he.ReturnReason,Return_Date:new Date(he.ModalDateReturn).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}),TempID:e.TempID};Re((function(e){return[].concat((0,i.Z)(e),[t])}))}var Dt=function(){var e,t,n,o=Fe.reduce((function(e,t){return e+parseFloat(t.Credit.replace(/,/g,""))}),0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2});if(he.Amount!==o)return(0,w.flushSync)((function(){Me(!1)})),I().fire({text:"Debit must eequal to Credit!",icon:"warning",showCancelButton:!1,timer:1500,position:"center"});if(null!==(e=Xe.current)&&void 0!==e&&e.getSelectedRows()){var a,r=null===(a=Xe.current)||void 0===a?void 0:a.getSelectedRows(),c=r[r.length-1];Re((function(e){return e=e.filter((function(e){return e.TempID!==c.TempID}))})),_e((function(e){return e=e.filter((function(e){return e.Check_No!==c.Check_No}))})),xt((0,l.Z)((0,l.Z)({},c),{},{Official_Receipt:c.OR_NO,Date_OR:c.OR_Date,BankAccount:c.Bank_Account}))}else{var u,d=null===(u=Ke.current)||void 0===u?void 0:u.getSelectedRows();xt(d[d.length-1])}function s(e){var t=e.length>0?e[e.length-1].TempID:"000";return(parseInt(t.match(/\d+/)[0])+1).toString().padStart(3,"0")}Fe.forEach((function(e){_e((function(t){return[].concat((0,i.Z)(t),[{Code:e.CRCode,AccountName:e.CRTitle,Debit:e.Credit,Credit:"0.00",IDNo:e.ID_No,Identity:e.Short,SubAcct:e.SubAcctCode,SubAcctName:e.SubAcctName,Check_No:he.subSelectedChecks.Check_No,Bank:he.subSelectedChecks.Bank,Check_Date:he.subSelectedChecks.Check_Date,Check_Return:he.ModalDateReturn,Check_Reason:he.ReturnReason,PK:he.subSelectedChecks.Check_No,DepoDate:he.subSelectedChecks.DepoDate,Date_Collection:he.subSelectedChecks.Date_Collection,TempID:s(t)}])}))})),console.log(he),_e((function(e){return e=[].concat((0,i.Z)(e),[{Code:he.AccountID,AccountName:he.AccountName,Debit:"0.00",Credit:he.Amount,IDNo:he.depoBankName,Identity:he.depoBankIdentity,SubAcct:he.BranchCode,SubAcctName:he.SubAccount,Check_No:he.subSelectedChecks.Check_No,Bank:he.subSelectedChecks.Bank,Check_Date:he.subSelectedChecks.Check_Date,Check_Return:he.ModalDateReturn,Check_Reason:he.ReturnReason,PK:he.subSelectedChecks.Check_No,DepoDate:he.subSelectedChecks.DepoDate,Date_Collection:he.subSelectedChecks.Date_Collection,TempID:s(e)}])})),Me(!1),null===(t=Ke.current)||void 0===t||t.removeSelection(),null===(n=Xe.current)||void 0===n||n.removeSelection()},Ct=""===le.returnMode;return(0,z.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",flex:1},children:[(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"5px"},children:[st?(0,z.jsx)(b.Z,{loading:st}):(0,z.jsx)(d.Z,{label:"Search",size:"small",name:"search",value:le.search,onChange:pt,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return e.preventDefault(),dt(e.target.value)},InputProps:{style:{height:"27px",fontSize:"14px"}},sx:{width:"300px",height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),""===le.returnMode&&(0,z.jsx)(s.Z,{sx:{height:"30px",fontSize:"11px"},variant:"contained",startIcon:(0,z.jsx)(y.Z,{sx:{width:15,height:15}}),id:"entry-header-save-button",onClick:function(){ue({type:"UPDATE_FIELD",field:"returnMode",value:"add"})},children:"New"}),(0,z.jsx)(b.Z,{sx:{height:"30px",fontSize:"11px"},id:"save-entry-header",color:"primary",variant:"contained",type:"submit",onClick:mt,disabled:""===le.returnMode,startIcon:(0,z.jsx)(R.Z,{sx:{width:15,height:15}}),loading:rt,children:"edit"===le.returnMode?"Update":"Save"}),""!==le.returnMode&&(0,z.jsx)(s.Z,{sx:{height:"30px",fontSize:"11px"},variant:"contained",startIcon:(0,z.jsx)(N.Z,{sx:{width:15,height:15}}),color:"error",onClick:function(){I().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!"}).then((function(e){e.isConfirmed&&(Je(),Re([]),_e([]),ue({type:"UPDATE_FIELD",field:"returnMode",value:""}),ee(ue,W),Ye())}))},children:"Cancel"})]}),(0,z.jsx)("br",{}),(0,z.jsxs)("form",{onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||e.preventDefault()},style:{display:"flex",gap:"10px"},children:[He?(0,z.jsx)(b.Z,{loading:He}):(0,z.jsxs)(h.Z,{sx:{width:"200px",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},variant:"outlined",size:"small",disabled:Ct,children:[(0,z.jsx)(p.Z,{htmlFor:"return-check-id-field",children:"Ref. No."}),(0,z.jsx)(f.Z,{sx:{height:"27px",fontSize:"14px"},disabled:Ct,fullWidth:!0,label:"Ref. No.",name:"RefNo",value:le.RefNo,onChange:pt,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return mt(e)},readOnly:"UCSMI"!==(null===ae||void 0===ae?void 0:ae.department),id:"return-check-id-field",endAdornment:(0,z.jsx)(m.Z,{position:"end",children:(0,z.jsx)(x.Z,{ref:Be,disabled:Ct,"aria-label":"search-client",color:"secondary",edge:"end",onClick:function(){Ye()},children:(0,z.jsx)(_.Z,{})})})})]}),(0,z.jsx)(v.Z,{disabled:Ct,label:"Date Returned",onChange:function(e){ue({type:"UPDATE_FIELD",field:"DateReturn",value:e})},value:new Date(le.DateReturn),onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var t=setTimeout((function(){var e,n;null===(e=Pe.current)||void 0===e||null===(n=e.querySelector("button"))||void 0===n||n.click(),clearTimeout(t)}),150)},textField:{InputLabelProps:{style:{fontSize:"14px"}},InputProps:{style:{height:"27px",fontSize:"14px"}}},datePickerRef:Pe}),(0,z.jsx)(d.Z,{disabled:Ct,fullWidth:!0,label:"Explanation",size:"small",name:"Explanation",value:le.Explanation,onChange:pt,onKeyDown:function(e){"Enter"!==e.code&&e.code},InputProps:{style:{height:"27px",fontSize:"14px"},readOnly:!0},sx:{flex:1,".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},inputRef:ze}),(0,z.jsx)("button",{ref:We,style:{display:"none"},type:"submit"})]}),(0,z.jsx)("br",{}),(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,z.jsx)("div",{children:q.map((function(e,t){return(0,z.jsxs)("button",{style:{border:"none",outline:"none",backgroundColor:"rgba(51, 51, 51, 0.05)",borderWidth:"0",color:me===t?"#7e22ce":"#333333",cursor:"pointer",display:"inline-block",fontFamily:'"Haas Grot Text R Web", "Helvetica Neue", Helvetica, Arial, sans-serif',fontSize:"14px",fontWeight:"500",lineHeight:"20px",listStyle:"none",margin:"0",padding:"10px 12px",textAlign:"center",transition:"all 200ms",verticalAlign:"baseline",whiteSpace:"nowrap",userSelect:"none",touchAction:"manipulation",position:"relative",overflow:"hidden"},onClick:function(){return De(t)},children:[(0,z.jsx)("span",{style:{position:"absolute",top:0,bottom:0,left:0,right:0,background:"rgba(206, 214, 211, 0.18)",transition:"all 200ms",transform:te(me,t)}}),e.title]},t)}))}),(0,z.jsxs)("div",{children:["Total Amount:"," ",(0,z.jsx)("strong",{children:Ie.reduce((function(e,t){return e+parseFloat(t.Credit.replace(/,/g,""))}),0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),(0,z.jsx)("br",{}),(0,z.jsx)(K.Provider,{value:{checkCollection:ke,checkSelectedCollection:ye,accountingEntry:Ie,LoadingCheckList:Ve,addReturnCheckLoading:rt,tableSelectedCheck:Ke,dispatchModal:pe,modalSelectedMutate:tt,getSearchReturnCheckInfoLoading:it,debitModalCollection:Fe,tableAccountingEntryCheck:qe,tableSelectedCheckReturn:Xe,modalSelectedCheckLoading:et,myAxios:oe,user:ae,setCheckCollection:Se,openSelectedCheckModal:we,setOpenSelectedCheckModal:Me,currentStepIndex:me,fireModal:Y,stateModal:he,datePickerModalRef:Ue,setAccountingEntry:_e,handleModalInputChange:ft,LoadSelectedCheckInSelectedTable:xt,setCheckSelectedCollection:Re},children:(0,z.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:1},id:"container",children:[xe,ut,(0,z.jsx)(D.Z,{open:we,onClose:function(){var e,t;Me(!1),null===(e=Ke.current)||void 0===e||e.removeSelection(),null===(t=Xe.current)||void 0===t||t.removeSelection()},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",onKeyDown:function(e){1!==me||"Backspace"!==e.code&&"Delete"!==e.code||(Me(!1),Y({onConfirmCallback:function(){Re((function(e){return e.filter((function(e){return e.TempID.toString()!==he.TempID.toString()}))})),_e((function(e){return e.filter((function(e){return e.Check_No.split("-")[0]!==he.Check_No.toString()}))}))},onCancelCallback:function(){var e,t;Me(!1),null===(e=Ke.current)||void 0===e||e.removeSelection(),null===(t=Xe.current)||void 0===t||t.removeSelection()}})),0!==me||"Enter"!==e.code&&"NumpadEnter"!==e.code||Dt()},children:(0,z.jsxs)(C.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",bgcolor:"background.paper",p:3,boxSizing:"border-box"},children:[(0,z.jsx)(x.Z,{style:{position:"absolute",top:"10px",right:"10px"},"aria-label":"search-client",onClick:function(){var e,t;Me(!1),null===(e=Ke.current)||void 0===e||e.removeSelection(),null===(t=Xe.current)||void 0===t||t.removeSelection(),pe({type:"UPDATE_FIELD",field:"TempID",value:""}),pe({type:"UPDATE_FIELD",field:"subSelectedChecks",value:{}})},children:(0,z.jsx)(N.Z,{})}),(0,z.jsxs)(g.Z,{id:"modal-modal-title",variant:"body1",component:"h2",children:["Return Detail and Accounting Entry (Check No.:",(0,z.jsx)("strong",{children:he.Check_No}),")"]}),(0,z.jsxs)("fieldset",{style:{display:"flex",columnGap:"10px",padding:"10px",border:"1px solid #cbd5e1",borderRadius:"5px",marginTop:"20px"},children:[(0,z.jsx)("legend",{style:{fontSize:"14px"},children:"Return Detail"}),(0,z.jsxs)(h.Z,{size:"small",variant:"outlined",fullWidth:!0,sx:{".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-1px"}},children:[(0,z.jsx)(p.Z,{id:"label-selection-reason",children:"Return Reason"}),(0,z.jsxs)(k.Z,{labelId:"label-selection-reason",value:he.ReturnReason,name:"ReturnReason",onChange:ft,autoWidth:!0,sx:{height:"27px",fontSize:"14px"},children:[(0,z.jsx)(S.Z,{value:"DAIF",children:"DAIF"}),(0,z.jsx)(S.Z,{value:"DAUD",children:"DAUD"}),(0,z.jsx)(S.Z,{value:"AC",children:"ACCOUNT CLOSED"}),(0,z.jsx)(S.Z,{value:"SPO",children:"SPO"}),(0,z.jsx)(S.Z,{value:"SD",children:"SIGNATURE DIFFERS"})]})]}),(0,z.jsx)(v.Z,{fullWidth:!0,label:"Date Returned",onChange:function(e){pe({type:"UPDATE_FIELD",field:"ModalDateReturn",value:e.toLocaleDateString()})},value:new Date(he.ModalDateReturn),onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var t=setTimeout((function(){var e,n;null===(e=Ue.current)||void 0===e||null===(n=e.querySelector("button"))||void 0===n||n.click(),clearTimeout(t)}),150)},datePickerRef:Ue,textField:{InputLabelProps:{style:{fontSize:"14px"}},InputProps:{style:{height:"27px",fontSize:"14px"}}}})]}),(0,z.jsxs)("fieldset",{style:{display:"flex",columnGap:"10px",padding:"10px",border:"1px solid #cbd5e1",borderRadius:"5px",marginTop:"5px"},children:[(0,z.jsx)("legend",{style:{fontSize:"14px"},children:"Credit Entry"}),(0,z.jsxs)("div",{style:{display:"flex",gap:"10px",width:"100%"},children:[(0,z.jsx)(d.Z,{size:"small",label:"Account Name",name:"AccountName",value:he.Short,onChange:ft,InputProps:{readOnly:!0,style:{height:"27px",fontSize:"14px"}},sx:{flex:1,".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-1px"}}}),(0,z.jsx)(d.Z,{size:"small",label:"Account ID",name:"AccountID",value:he.AccountID,onChange:ft,InputProps:{readOnly:!0,style:{height:"27px",fontSize:"14px",width:"200px"}},sx:{".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-1px"}}}),(0,z.jsx)(d.Z,{size:"small",label:"Amount",name:"Amount",value:he.Amount,onChange:ft,InputProps:{readOnly:!0,style:{height:"27px",fontSize:"14px",width:"200px"}},sx:{".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-1px"}}}),(0,z.jsx)(d.Z,{size:"small",label:"Sub Account",name:"SubAccount",value:he.SubAccount,onChange:ft,InputProps:{readOnly:!0,style:{height:"27px",fontSize:"14px",width:"200px"}},sx:{".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-1px"}}})]})]}),(0,z.jsxs)("fieldset",{style:{display:"flex",columnGap:"10px",border:"1px solid #cbd5e1",borderRadius:"5px",marginTop:"5px"},children:[(0,z.jsx)("legend",{style:{fontSize:"14px"},children:"Debit Entry"}),(0,z.jsx)("div",{style:{marginTop:"10px",width:"100%",position:"relative",height:"300px"},children:(0,z.jsx)("div",{style:{marginTop:"10px",width:"100%",position:"relative"},children:(0,z.jsx)(C.Z,{style:{height:"300px",width:"100%",overflowX:"scroll",position:"absolute"},children:(0,z.jsx)(M.Z,{isLoading:et,columns:X,rows:Fe,table_id:"TempID",isSingleSelection:!0,isRowFreeze:!0,checkboxSelection:!1,footerChildren:function(){return(0,z.jsx)(ne,{})},footerPaginationPosition:"left-right",showFooterSelectedCount:!1})})})})]}),(0,z.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"20px",marginTop:"15px"},children:(0,z.jsxs)("div",{children:[(0,z.jsx)(s.Z,{color:"success",variant:"contained",onClick:Dt,style:{marginRight:"10px"},startIcon:(0,z.jsx)(j.Z,{}),sx:{height:"30px",fontSize:"14px",textTransform:"none"},children:"Accept"}),(0,z.jsx)(s.Z,{color:"error",variant:"contained",onClick:function(){var e,t;Me(!1),null===(e=Ke.current)||void 0===e||e.removeSelection(),null===(t=Xe.current)||void 0===t||t.removeSelection(),pe({type:"UPDATE_FIELD",field:"TempID",value:""}),pe({type:"UPDATE_FIELD",field:"subSelectedChecks",value:{}})},startIcon:(0,z.jsx)(F.Z,{}),sx:{height:"30px",fontSize:"14px",textTransform:"none"},children:"Cancel"})]})})]})}),(0,z.jsx)(H,{})]})})]})}var Y={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center"},modal:{backgroundColor:"#fff",padding:"20px",borderRadius:"5px",textAlign:"center",width:"300px"},button:{margin:"0 10px",background:"white",fontFamily:'"Roboto", sans-serif',color:"#475569",padding:"5px 10px"}},Q=function(){var e=(0,u.useState)(!1),t=(0,r.Z)(e,2),n=t[0],i=t[1],o=(0,u.useState)((function(){return function(){}})),a=(0,r.Z)(o,2),c=a[0],l=a[1],d=(0,u.useState)((function(){return function(){}})),s=(0,r.Z)(d,2),h=s[0],p=s[1],f=function(){h(),i(!1)},m=function(){c(),i(!1)};return{ConfirmationModal:function(){var e=(0,u.useRef)(null);return(0,u.useEffect)((function(){var t;n&&(null===(t=e.current)||void 0===t||t.focus())}),[]),n?(0,z.jsx)("div",{style:Y.overlay,children:(0,z.jsxs)("div",{style:Y.modal,children:[(0,z.jsx)("p",{style:{color:"black"},children:"Do you want to proceed?"}),(0,z.jsx)("button",{ref:e,onClick:m,style:Y.button,children:"Yes"}),(0,z.jsx)("button",{onClick:f,style:Y.button,children:"No"})]})}):null},fireModal:function(e){i(!0),l((function(){return e.onConfirmCallback})),p((function(){return e.onCancelCallback}))}}};function V(){var e,t,n=(0,u.useContext)(K),i=n.checkCollection,r=n.LoadingCheckList,c=n.dispatchModal,l=n.modalSelectedMutate,s=n.checkSelectedCollection,h=n.getSearchReturnCheckInfoLoading,p=n.tableSelectedCheck,f=n.myAxios,m=n.setCheckCollection,x=n.user,D=(0,u.useRef)(null),C=(0,E.useMutation)({mutationKey:"check-list",mutationFn:function(t){return(e=e||(0,a.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.get("/task/accounting/get-check-list?checkListSearch=".concat(t.searchCheckList),{headers:{Authorization:"Bearer ".concat(null===x||void 0===x?void 0:x.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){m(e.data.checkList)}}),g=C.isLoading,k=C.mutate,S=(0,U.XT)();return(0,z.jsxs)(u.Fragment,{children:[(0,z.jsx)(d.Z,{inputRef:D,label:"Search by check no.",name:"searchCheckList",onKeyDown:function(e){var t;"Enter"!==e.code&&"NumpadEnter"!==e.code||k({searchCheckList:null===(t=D.current)||void 0===t?void 0:t.value});(0,U.rO)(e,S,null===D||void 0===D?void 0:D.current)},InputProps:{style:{height:"27px",fontSize:"14px"},inputRef:D},sx:{".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-13px"}}}),(0,z.jsx)("div",{style:{marginTop:"10px",width:"100%",position:"relative"},children:(0,z.jsx)("div",{className:S,style:{height:"".concat((null===(t=document.getElementById("container"))||void 0===t?void 0:t.getBoundingClientRect().height)-30,"px"),width:"100%",overflowX:"scroll",position:"absolute"},children:(0,z.jsx)(M.Z,{ref:p,isLoading:r||h||g,columns:[{field:"DepoSlip",headerName:"Deposit Slip",minWidth:140},{field:"DepoDate",headerName:"Deposit Date",minWidth:140},{field:"Check_No",headerName:"Check No",minWidth:140},{field:"Check_Date",headerName:"Check Date",minWidth:140},{field:"Amount",headerName:"Amount",minWidth:160,align:"right"},{field:"Bank",headerName:"Bank",minWidth:300}],rows:i,table_id:"TempID",isSingleSelection:!0,isRowFreeze:!0,dataSelection:function(e,t,n){var i=t.filter((function(t){return t.TempID===e[0]}))[0];void 0===i||i.length<=0||(c({type:"UPDATE_FIELD",field:"subSelectedChecks",value:{Check_No:i.Check_No,Bank:i.Bank,Check_Date:i.Check_Date,PK:i.Check_No,DepoDate:i.DepoDate,Date_Collection:i.Date_OR,TempID:i.TempID}}),c({type:"UPDATE_FIELD",field:"ReturnReason",value:"DAIF"}),c({type:"UPDATE_FIELD",field:"TempID",value:i.TempID}),c({type:"UPDATE_FIELD",field:"Check_No",value:i.Check_No}),l({BankAccount:i.BankAccount,Official_Receipt:i.Official_Receipt}))},isRowSelectable:function(e){return!s.map((function(e){return e.Check_No})).includes(e.row.Check_No)}})})})]})}function J(){var e,t=(0,u.useContext)(K),n=t.dispatchModal,i=t.modalSelectedMutate,o=t.checkSelectedCollection,a=t.tableSelectedCheckReturn;return(0,z.jsx)("div",{style:{marginTop:"10px",width:"100%",position:"relative"},children:(0,z.jsx)(C.Z,{style:{height:"".concat((null===(e=document.getElementById("container"))||void 0===e?void 0:e.getBoundingClientRect().height)-30,"px"),width:"100%",overflowX:"scroll",position:"absolute"},children:(0,z.jsx)(M.Z,{ref:a,isLoading:!1,columns:[{field:"OR_NO",headerName:"OR No.",minWidth:170},{field:"OR_Date",headerName:"OR Date",minWidth:160},{field:"DepoSlip",headerName:"Deposit Slip",minWidth:160},{field:"DepoDate",headerName:"Deposit Date",minWidth:160},{field:"Check_No",headerName:"Check No",minWidth:160},{field:"Check_Date",headerName:"Check Date",minWidth:160},{field:"Amount",headerName:"Amount",minWidth:160,align:"right"},{field:"Bank",headerName:"Bank/Branch",minWidth:160},{field:"Bank_Account",headerName:"Bank Account",minWidth:160},{field:"Reason",headerName:"Reason",minWidth:160},{field:"Return_Date",headerName:"Return Date",minWidth:160}],rows:o,table_id:"TempID",isSingleSelection:!0,isRowFreeze:!0,dataSelection:function(e,t,o){var a=t.filter((function(t){return t.TempID===e[0]}))[0];void 0===a||a.length<=0||(n({type:"UPDATE_FIELD",field:"subSelectedChecks",value:{Check_No:a.Check_No,Bank:a.Bank,Check_Date:a.Check_Date,PK:a.Check_No,DepoDate:a.DepoDate,Date_Collection:a.OR_Date,TempID:a.TempID}}),n({type:"UPDATE_FIELD",field:"ReturnReason",value:a.Reason}),n({type:"UPDATE_FIELD",field:"ModalDateReturn",value:a.Return_Date}),n({type:"UPDATE_FIELD",field:"TempID",value:a.TempID}),n({type:"UPDATE_FIELD",field:"Check_No",value:a.Check_No}),i({BankAccount:a.Bank_Account,Official_Receipt:a.OR_NO}))}})})})}function $(){var e,t=(0,u.useContext)(K),n=t.accountingEntry,i=t.tableAccountingEntryCheck;return(0,z.jsx)("div",{style:{marginTop:"10px",width:"100%",position:"relative"},children:(0,z.jsx)(C.Z,{style:{height:"".concat((null===(e=document.getElementById("container"))||void 0===e?void 0:e.getBoundingClientRect().height)-30,"px"),width:"100%",overflowX:"scroll",position:"absolute"},children:(0,z.jsx)(M.Z,{ref:i,isLoading:!1,columns:[{field:"Code",headerName:"Code",minWidth:170},{field:"AccountName",headerName:"Account Name",minWidth:160},{field:"Debit",headerName:"Debit",minWidth:160,align:"right"},{field:"Credit",headerName:"Credit",minWidth:160,align:"right"},{field:"IDNo",headerName:"ID No.",minWidth:160},{field:"Identity",headerName:"Identity",minWidth:160},{field:"SubAcct",headerName:"Sub Acct",minWidth:160},{field:"SubAcctName",headerName:"Sub Acct Name",minWidth:300},{field:"Check_No",headerName:"Check No",minWidth:160},{field:"Bank",headerName:"Bank/Branch",minWidth:160},{field:"Check_Date",headerName:"Check Date",minWidth:160},{field:"Check_Return",headerName:"Check Return",minWidth:160},{field:"Check_Reason",headerName:"Check Reason",minWidth:160},{field:"PK",headerName:"PK",minWidth:160},{field:"DepoDate",headerName:"Date Deposit",minWidth:160},{field:"Date_Collection",headerName:"Date Collection",minWidth:160}],rows:n,table_id:"TempID",isSingleSelection:!0,isRowFreeze:!0,checkboxSelection:!1,footerPaginationPosition:"left-right",footerChildren:function(){return(0,z.jsx)(ie,{})},showFooterSelectedCount:!1})})})}function ee(e,t){Object.entries(t).forEach((function(t){var n=(0,r.Z)(t,2),i=n[0],o=n[1];e({type:"UPDATE_FIELD",field:i,value:o})}))}function te(e,t){return e===t?"translateX(100%)":"translateX(0%)"}function ne(){var e=(0,u.useContext)(K).debitModalCollection;return(0,z.jsx)(C.Z,{sx:{px:2,py:1,display:"flex",justifyContent:"flex-end",borderTop:"2px solid #e2e8f0"},children:(0,z.jsxs)("strong",{children:["Total:"," ",e.reduce((function(e,t){return e+parseFloat(t.Credit.replace(/,/g,""))}),0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})]})})}function ie(){var e=(0,u.useContext)(K).accountingEntry;return(0,z.jsxs)(C.Z,{sx:{px:2,py:1,display:"flex",justifyContent:"flex-end",borderTop:"2px solid #e2e8f0"},children:[(0,z.jsx)("span",{style:{marginRight:"10px"},children:"Total:"}),(0,z.jsx)("input",{style:{fontWeight:"bold"},type:"text",readOnly:!0,value:e.reduce((function(e,t){return e+parseFloat(t.Credit.replace(/,/g,""))}),0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),(0,z.jsx)("input",{style:{fontWeight:"bold"},type:"text",readOnly:!0,value:e.reduce((function(e,t){return e+parseFloat(t.Debit.replace(/,/g,""))}),0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})})]})}},25756:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(29439),o=n(72791);function a(e){var t=(0,o.useState)(0),n=(0,i.Z)(t,2),a=n[0],r=n[1];return{step:e[a],goTo:function(e){r(e)},back:function(){r((function(e){return e<=0?e:e+1}))},next:function(){r((function(t){return t>=e.length-1?t:t+1}))},isFirstStep:0!==a,isLastStep:a===e.length-1,currentStepIndex:a}}},98946:function(e,t,n){"use strict";var i=n(64836);t.Z=void 0;var o=i(n(45649)),a=n(80184),r=(0,o.default)((0,a.jsx)("path",{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"CheckCircleOutline");t.Z=r},24654:function(){},45987:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(63366);function o(e,t){if(null==e)return{};var n,o,a=(0,i.Z)(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}}}]);
//# sourceMappingURL=4641.4b2c3616.chunk.js.map