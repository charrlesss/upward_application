"use strict";(self.webpackChunkupward=self.webpackChunkupward||[]).push([[9032],{23508:function(t,e,n){n.d(e,{bq:function(){return d}});var a,i=n(74165),o=n(15861);function r(t){var e=t.data,n=t.column,a=t.beforeArrangeData,i=t.adjustMaxHeight,o=t.fontSize,r=void 0===o?"11px":o,d=t.summaryHeight,l=void 0===d?0:d,s=[],c=0,u=[],p=document.querySelector(".content").getBoundingClientRect().height-i;return e.forEach((function(t,i){t=a(t);var o=document.querySelector(".content"),d=document.createElement("table"),h=d.insertRow();t.summaryReport&&p-c<=l+20&&(c+=p-c),n.forEach((function(e){var n=h.insertCell();d.style.visibility="hidden",d.style.width="100%",d.style.fontSize=r,function(t,e,n,a,i){t.style.width=n,t.textContent=e,a.appendChild(i)}(n,t[e.datakey],e.width,o,d)})),c+=h.getBoundingClientRect().height,o.removeChild(d),u.push(t),(c>=p||i===e.length-1&&c<p)&&(s.push(u),c=0,u=[])})),s}var d=function(t){return(a=a||(0,o.Z)((0,i.Z)().mark((function t(e){var n,a,o,d,l,s,c,u;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.data,a=e.column,o=e.beforeArrangeData,d=e.adjustMaxHeight,l=e.cb,s=e.fontSize,c=void 0===s?"11px":s,u=e.summaryHeight,void 0!==n){t.next=3;break}return t.abrupt("return",[]);case 3:if(!l){t.next=5;break}return t.abrupt("return",l({data:n,column:a,beforeArrangeData:o,adjustMaxHeight:d}));case 5:return t.abrupt("return",r({data:n,column:a,beforeArrangeData:o,adjustMaxHeight:d,fontSize:c,summaryHeight:u}));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},76049:function(t,e,n){n.r(e),n.d(e,{default:function(){return k}});var a=n(29439),i=n(93433),o=n(74165),r=n(15861),d=n(72791),l=n(71012),s=n(3380),c=n(71652),u=n(93777),p=n(48550),h=n(68096),x=n(94925),g=n(58406),f=n(23786),y=n(93862),m=n(91933),_=n(39709),v=n(54164),I={COM:[{datakey:"AssuredName",header:"ASSURED NAME",width:"350px"},{datakey:"PolicyNo",header:"POLICY NO",width:"300px"},{datakey:"Expiration",header:"EXPIRATION",width:"150px"},{datakey:"InsuredValue",header:"AMOUNT INSURED",width:"150px",type:"number"},{datakey:"Make",header:"MAKE",width:"250px"},{datakey:"BodyType",header:"BODY TYPE",width:"250px"},{datakey:"PlateNo",header:"PLATE NO",width:"250px"},{datakey:"ChassisNo",header:"CHASSIS NO",width:"250px"},{datakey:"MotorNo",header:"ENGINE NO",width:"250px"},{datakey:"TotalPremium",header:"TOTAL PREMIUM",width:"150px",type:"number"},{datakey:"Mortgagee",header:"MORTGAGEE",width:"350px"}],FIRE:[{datakey:"AssuredName",header:"ASSURED NAME",width:"350px"},{datakey:"PolicyNo",header:"POLICY NO",width:"300px"},{datakey:"Expiration",header:"EXPIRATION",width:"120px"},{datakey:"InsuredValue",header:"AMOUNT INSURED",width:"150px",type:"number"},{datakey:"TotalPremium",header:"TOTAL PREMIUM",width:"150px",type:"number"},{datakey:"Mortgage",header:"MORTGAGEE",width:"300px"}],MAR:[{datakey:"AssuredName",header:"ASSURED NAME",width:"350px"},{datakey:"PolicyNo",header:"POLICY NO",width:"300px"},{datakey:"Expiration",header:"EXPIRATION",width:"120px"},{datakey:"InsuredValue",header:"AMOUNT INSURED",width:"150px",type:"number"},{datakey:"TotalPremium",header:"TOTAL PREMIUM",width:"150px",type:"number"}],PA:[{datakey:"AssuredName",header:"ASSURED NAME",width:"350px"},{datakey:"PolicyNo",header:"POLICY NO",width:"300px"},{datakey:"Expiration",header:"EXPIRATION",width:"120px"},{datakey:"TotalPremium",header:"TOTAL PREMIUM",width:"150px",type:"number"}]},b=function(t){return I[t]},A=n(23508),S=n(80184),E={dateFrom:new Date,policy:"COM",type:"Regular",account:"All",title:""},P=["DateIssued","PolicyNo","AssuredName","EffictiveDate"];function w(t){var e,n=t.state,a=t.dispatch,l=(0,d.useContext)(s.V),v=l.myAxios,I=l.user,b=(0,m.useQuery)({queryKey:"account",queryFn:function(){return(e=e||(0,r.Z)((0,o.Z)().mark((function t(){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.get("/reports/reports/report-fields/accounts",{headers:{Authorization:"Bearer ".concat(null===I||void 0===I?void 0:I.accessToken)}});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}),A=b.data,E=b.isLoading,P=function(t){var e=t.target,n=e.name,i=e.value;"policy"===n&&"TPL"!==i&&a({type:"UPDATE_FIELD",field:"mortgagee",value:""}),"mortgagee"===n&&""!==i&&a({type:"UPDATE_FIELD",field:"account",value:""}),a({type:"UPDATE_FIELD",field:n,value:i})};return(0,S.jsxs)("div",{style:{padding:"10px"},children:[(0,S.jsx)(p.Z,{label:"Title",fullWidth:!0,name:"title",value:n.title,onChange:P,rows:6,multiline:!0,InputProps:{style:{height:"140px",fontSize:"12px"}},sx:{flex:1,".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),(0,S.jsxs)("div",{style:{height:"100%",display:"grid",gridTemplateColumns:"repeat(2,1fr)",gap:"10px",margin:"10px 0"},children:[(0,S.jsx)(c._,{dateAdapter:y.H,children:(0,S.jsx)(u.M,{sx:{width:"100%",".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},slotProps:{textField:{size:"small",name:"",InputLabelProps:{style:{fontSize:"14px"}},InputProps:{style:{height:"27px",fontSize:"14px"}}}},label:"Date",views:["month","year"],value:n.dateFrom,onChange:function(t){a({type:"UPDATE_FIELD",field:"dateFrom",value:t}),n.dateFrom=t,a({type:"UPDATE_FIELD",field:"title",value:j(n,null===I||void 0===I?void 0:I.department)})}})}),(0,S.jsxs)(h.Z,{fullWidth:!0,variant:"outlined",size:"small",sx:{".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},children:[(0,S.jsx)(x.Z,{id:"policy",children:"Policy"}),(0,S.jsxs)(g.Z,{id:"policy",label:"Policy",value:n.policy,name:"policy",onChange:function(t){P(t),n.policy=t.target.value,a({type:"UPDATE_FIELD",field:"title",value:j(n,null===I||void 0===I?void 0:I.department)})},sx:{height:"27px",fontSize:"14px"},children:[(0,S.jsx)(f.Z,{value:"COM",children:"COM"}),(0,S.jsx)(f.Z,{value:"FIRE",children:"FIRE"}),(0,S.jsx)(f.Z,{value:"MAR",children:"MAR"}),(0,S.jsx)(f.Z,{value:"PA",children:"PA"})]})]}),E?(0,S.jsx)(_.Z,{loading:E}):(0,S.jsxs)(h.Z,{fullWidth:!0,variant:"outlined",size:"small",sx:{".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},children:[(0,S.jsx)(x.Z,{id:"account",children:"Account"}),(0,S.jsx)(g.Z,{id:"account",label:"Account",value:n.account,name:"account",onChange:function(t){P(t),n.account=t.target.value,a({type:"UPDATE_FIELD",field:"title",value:j(n,null===I||void 0===I?void 0:I.department)})},sx:{height:"27px",fontSize:"14px"},children:[{Account:"All"}].concat((0,i.Z)(null===A||void 0===A?void 0:A.data.accounts)).map((function(t,e){return(0,S.jsx)(f.Z,{value:t.Account,children:t.Account},e)}))})]}),"COM"===n.policy&&(0,S.jsxs)(h.Z,{fullWidth:!0,variant:"outlined",size:"small",sx:{".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},children:[(0,S.jsx)(x.Z,{id:"paper-format-1",children:"Type"}),(0,S.jsxs)(g.Z,{labelId:"paper-format-1",value:n.type,label:"Type",name:"type",onChange:P,sx:{height:"27px",fontSize:"14px"},children:[(0,S.jsx)(f.Z,{value:"Regular",children:"Regular"}),(0,S.jsx)(f.Z,{value:"Temporary",children:"Temporary"})]})]})]})]})}function k(){var t,e=(0,d.useContext)(s.V),n=e.myAxios,i=e.user;E.title=j(E,null===i||void 0===i?void 0:i.department);var c=(0,d.useState)(b(E.policy)),u=(0,a.Z)(c,2),p=u[0],h=u[1];return(0,S.jsx)(l.ZP,{column:p,initialState:E,Setting:function(t,e){return(0,S.jsx)(w,{state:t,dispatch:e})},onReportSubmit:function(e,a,d){return(t=t||(0,r.Z)((0,o.Z)().mark((function t(e,a,r){var d,s,c;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d=b(r.policy),(0,v.flushSync)((function(){h(d)})),t.next=4,n.post("/reports/reports/renewal-notice",r,{headers:{Authorization:"Bearer ".concat(null===i||void 0===i?void 0:i.accessToken)}});case 4:return s=t.sent,t.next=7,s.data;case 7:c=t.sent,(0,A.bq)({data:c.report,column:d,beforeArrangeData:function(t){var e=d.filter((function(t){return"number"===t.type})).map((function(t){return t.datakey}));return e.forEach((function(e){t.hasOwnProperty(e)&&(t[e]=(0,l.pw)(parseFloat(t[e].toString().replace(/,/g,""))))})),t},adjustMaxHeight:320}).then((function(t){e(t),a(!1)}));case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)},scaleDefaultValue:100,drawTable:function(t,e){return t.map((function(n,a){return(0,S.jsxs)("div",{className:"page out-page",children:[(0,S.jsx)("div",{className:"header",style:{height:"50px"}}),(0,S.jsx)("div",{className:"content",children:(0,S.jsxs)("table",{children:[(0,S.jsxs)("thead",{children:[e.title.split("\n").map((function(t,e){return(0,S.jsx)("tr",{children:(0,S.jsx)("td",{style:{fontSize:"14px",fontWeight:"bold",textAlign:"left"},colSpan:p.length,children:t})},e)})),(0,S.jsx)("tr",{style:{height:"40px"}}),(0,S.jsx)("tr",{style:{borderBottom:"1px solid black"},children:p.map((function(e,n){return(0,S.jsx)("th",{onDoubleClick:function(n){return(0,l.PE)(n,e.datakey,t)},style:{width:e.width,fontSize:"12px",fontWeight:"bold",textAlign:P.includes(e.datakey)?"left":"center"},children:e.header},n)}))})]}),(0,S.jsx)("tbody",{children:n.map((function(t,e){return(0,S.jsx)("tr",{children:p.map((function(n,i){return(0,S.jsx)("td",{onClick:l.mp,className:"page-".concat(a," row-").concat(e,"_col-").concat(i),style:{width:n.width,fontSize:"AssuredName"===n.datakey?"10px":"11px",fontWeight:"500",textAlign:"number"===n.type?"right":"left"},children:t[n.datakey]},i)}))},e)}))}),(0,S.jsxs)("tfoot",{children:[a===t.length-1&&(0,S.jsxs)("tr",{children:[(0,S.jsxs)("td",{style:{fontWeight:"bold",fontSize:"11px"},colSpan:3,children:["No. of Records:"," ",(t.flat().length-1).toLocaleString("en-US")]}),p.map((function(e,n){if(!e.total)return n<3?(0,S.jsx)(d.Fragment,{},n):(0,S.jsx)("td",{},n);var a=t.flat().reduce((function(t,n){var a;return t+parseFloat(null===(a=n[e.datakey])||void 0===a?void 0:a.replace(/,/g,""))}),0);return(0,S.jsx)("td",{style:{borderTop:"1px solid black",fontWeight:"bold",textAlign:"right",fontSize:"11px"},children:isNaN(a)?"0":(0,l.pw)(a)},n)}))]}),(0,S.jsx)("tr",{style:{height:"50px"}}),(0,S.jsx)("tr",{children:(0,S.jsx)("td",{colSpan:p.length,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"center"},children:"Prepared: ________________________________ \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 Checked: ________________________________ \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Approved: ________________________________"})})]})]})}),(0,S.jsxs)("div",{className:"footer",style:{height:"50px",display:"flex",justifyContent:"space-between"},children:[(0,S.jsx)("p",{style:{fontSize:"10px",fontWeight:"bold"},children:"01/01/2024"}),(0,S.jsxs)("p",{style:{fontSize:"10px",fontWeight:"bold"},children:["Page ",a+1," of ",t.length]})]})]},a)}))}})}function j(t,e){return"".concat("UMIS"===e?"UPWARD MANAGEMENT INSURANCE SERVICES":"UPWARD CONSULTANCY SERVICES AND MANAGEMENT INC."," \nMonthly Production Report(").concat(t.policy," - ").concat(t.account,") ").concat("Summary"===t.format1?"Summary":"","\nCut off Date: ").concat(function(t){return t.dateFrom.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}(t))}},39709:function(t,e,n){n.d(e,{Z:function(){return I}});var a=n(4942),i=n(63366),o=n(87462),r=n(72791),d=n(14036),l=n(67384),s=n(94419),c=n(66934),u=n(31402),p=n(36151),h=n(13239),x=n(21217);function g(t){return(0,x.Z)("MuiLoadingButton",t)}var f=(0,n(75878).Z)("MuiLoadingButton",["root","loading","loadingIndicator","loadingIndicatorCenter","loadingIndicatorStart","loadingIndicatorEnd","endIconLoadingEnd","startIconLoadingStart"]),y=n(80184),m=["children","disabled","id","loading","loadingIndicator","loadingPosition","variant"],_=(0,c.ZP)(p.Z,{shouldForwardProp:function(t){return function(t){return"ownerState"!==t&&"theme"!==t&&"sx"!==t&&"as"!==t&&"classes"!==t}(t)||"classes"===t},name:"MuiLoadingButton",slot:"Root",overridesResolver:function(t,e){return[e.root,e.startIconLoadingStart&&(0,a.Z)({},"& .".concat(f.startIconLoadingStart),e.startIconLoadingStart),e.endIconLoadingEnd&&(0,a.Z)({},"& .".concat(f.endIconLoadingEnd),e.endIconLoadingEnd)]}})((function(t){var e=t.ownerState,n=t.theme;return(0,o.Z)((0,a.Z)({},"& .".concat(f.startIconLoadingStart,", & .").concat(f.endIconLoadingEnd),{transition:n.transitions.create(["opacity"],{duration:n.transitions.duration.short}),opacity:0}),"center"===e.loadingPosition&&(0,a.Z)({transition:n.transitions.create(["background-color","box-shadow","border-color"],{duration:n.transitions.duration.short})},"&.".concat(f.loading),{color:"transparent"}),"start"===e.loadingPosition&&e.fullWidth&&(0,a.Z)({},"& .".concat(f.startIconLoadingStart,", & .").concat(f.endIconLoadingEnd),{transition:n.transitions.create(["opacity"],{duration:n.transitions.duration.short}),opacity:0,marginRight:-8}),"end"===e.loadingPosition&&e.fullWidth&&(0,a.Z)({},"& .".concat(f.startIconLoadingStart,", & .").concat(f.endIconLoadingEnd),{transition:n.transitions.create(["opacity"],{duration:n.transitions.duration.short}),opacity:0,marginLeft:-8}))})),v=(0,c.ZP)("span",{name:"MuiLoadingButton",slot:"LoadingIndicator",overridesResolver:function(t,e){var n=t.ownerState;return[e.loadingIndicator,e["loadingIndicator".concat((0,d.Z)(n.loadingPosition))]]}})((function(t){var e=t.theme,n=t.ownerState;return(0,o.Z)({position:"absolute",visibility:"visible",display:"flex"},"start"===n.loadingPosition&&("outlined"===n.variant||"contained"===n.variant)&&{left:"small"===n.size?10:14},"start"===n.loadingPosition&&"text"===n.variant&&{left:6},"center"===n.loadingPosition&&{left:"50%",transform:"translate(-50%)",color:(e.vars||e).palette.action.disabled},"end"===n.loadingPosition&&("outlined"===n.variant||"contained"===n.variant)&&{right:"small"===n.size?10:14},"end"===n.loadingPosition&&"text"===n.variant&&{right:6},"start"===n.loadingPosition&&n.fullWidth&&{position:"relative",left:-10},"end"===n.loadingPosition&&n.fullWidth&&{position:"relative",right:-10})})),I=r.forwardRef((function(t,e){var n=(0,u.Z)({props:t,name:"MuiLoadingButton"}),a=n.children,r=n.disabled,c=void 0!==r&&r,p=n.id,x=n.loading,f=void 0!==x&&x,I=n.loadingIndicator,b=n.loadingPosition,A=void 0===b?"center":b,S=n.variant,E=void 0===S?"text":S,P=(0,i.Z)(n,m),w=(0,l.Z)(p),k=null!=I?I:(0,y.jsx)(h.Z,{"aria-labelledby":w,color:"inherit",size:16}),j=(0,o.Z)({},n,{disabled:c,loading:f,loadingIndicator:k,loadingPosition:A,variant:E}),M=function(t){var e=t.loading,n=t.loadingPosition,a=t.classes,i={root:["root",e&&"loading"],startIcon:[e&&"startIconLoading".concat((0,d.Z)(n))],endIcon:[e&&"endIconLoading".concat((0,d.Z)(n))],loadingIndicator:["loadingIndicator",e&&"loadingIndicator".concat((0,d.Z)(n))]},r=(0,s.Z)(i,g,a);return(0,o.Z)({},a,r)}(j),N=f?(0,y.jsx)(v,{className:M.loadingIndicator,ownerState:j,children:k}):null;return(0,y.jsxs)(_,(0,o.Z)({disabled:c||f,id:w,ref:e},P,{variant:E,classes:M,ownerState:j,children:["end"===j.loadingPosition?a:N,"end"===j.loadingPosition?N:a]}))}))}}]);
//# sourceMappingURL=9032.57d1b7e4.chunk.js.map